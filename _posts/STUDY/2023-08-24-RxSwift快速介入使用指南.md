---
title:  "RxSwiftå¿«é€Ÿæ¥å…¥ä½¿ç”¨æŒ‡å—"
date:   2023-08-24
desc: "å‡½æ•°å“åº”å¼ç¼–ç¨‹æ³¨å®šä¼šæ…¢æ…¢æˆä¸ºswiftçš„ä¸»æµç¼–ç æ–¹å¼ï¼Œç°åœ¨å¯ä»¥å­¦èµ·æ¥äº†"
keywords: "Combineã€RxSwiftã€å‡½æ•°å“åº”å¼ç¼–ç¨‹"
categories: [Tech, Study]
tags: []


---

æ›´è¯¦ç»†è¯·å‚è€ƒ https://beeth0ven.github.io/RxSwift-Chinese-Documentation/

## Observable å¯ç›‘å¬åºåˆ—









## Observer è§‚å¯Ÿè€…

ä¸€ä¸ªç‚¹å‡»äº‹ä»¶ï¼š

```swift
tap.subscribe(onNext: { [weak self] in
    self?.showAlert()
}, onError: { error in
    print("å‘ç”Ÿé”™è¯¯ï¼š \(error.localizedDescription)")
}, onCompleted: {
    print("ä»»åŠ¡å®Œæˆ")
})
```

**è§‚å¯Ÿè€…**å°±æ˜¯ç”±åé¢çš„ `onNext`ï¼Œ`onError`ï¼Œ`onCompleted`çš„è¿™äº›é—­åŒ…æ„å»ºå‡ºæ¥çš„ã€‚

å¯ä»¥æ”¹å†™æˆè¿™æ ·

```swift
let observer: AnyObserver<Data> = AnyObserver { (event) in
    switch event {
    case .next(let data):
        print("next")
    case .error(let error):
        print("error")
    case .completed:
     		print("completed")
    default:
        break
    }
}
tap.subscribe(observer)
```

ä»¥åŠè¿™ç§

```swift
usernameValid
    .bind(to: usernameValidOutlet.rx.isHidden)
    .disposed(by: disposeBag)

// å¯ä»¥å†™æˆ
let observer: AnyObserver<Bool> = AnyObserver { [weak self] (event) in
    switch event {
    case .next(let isHidden):
        self?.usernameValidOutlet.isHidden = isHidden
    default:
        break
    }
}

usernameValid
    .bind(to: observer)
    .disposed(by: disposeBag)
```

##  Schedulers è°ƒåº¦å™¨

å¤šçº¿ç¨‹æ“ä½œï¼Œè§å¦‚ä¸‹GCDå˜æ¢

```swift
// åå°å–å¾—æ•°æ®ï¼Œä¸»çº¿ç¨‹å¤„ç†ç»“æœ
DispatchQueue.global(qos: .userInitiated).async {
    let data = try? Data(contentsOf: url)
    DispatchQueue.main.async {
        self.data = data
    }
}

// å¯ä»¥ä½¿ç”¨rxswiftå¦‚ä¸‹
let rxData: Observable<Data> = ...

rxData
    .subscribeOn(ConcurrentDispatchQueueScheduler(qos: .userInitiated))
    .observeOn(MainScheduler.instance)
    .subscribe(onNext: { [weak self] data in
        self?.data = data
    })
    .disposed(by: disposeBag)
```

ç”¨ [subscribeOn](https://beeth0ven.github.io/RxSwift-Chinese-Documentation/content/decision_tree/subscribeOn.html) æ¥å†³å®šæ•°æ®åºåˆ—çš„æ„å»ºå‡½æ•°åœ¨å“ªä¸ª **Scheduler** ä¸Šè¿è¡Œã€‚ä»¥ä¸Šä¾‹å­ä¸­ï¼Œç”±äºè·å– `Data` éœ€è¦èŠ±å¾ˆé•¿çš„æ—¶é—´ï¼Œæ‰€ä»¥ç”¨ [subscribeOn](https://beeth0ven.github.io/RxSwift-Chinese-Documentation/content/decision_tree/subscribeOn.html) åˆ‡æ¢åˆ° **åå° Scheduler** æ¥è·å– `Data`ã€‚è¿™æ ·å¯ä»¥é¿å…ä¸»çº¿ç¨‹è¢«é˜»å¡ã€‚

ç”¨ [observeOn](https://beeth0ven.github.io/RxSwift-Chinese-Documentation/content/decision_tree/observeOn.html) æ¥å†³å®šåœ¨å“ªä¸ª **Scheduler** ç›‘å¬è¿™ä¸ªæ•°æ®åºåˆ—ã€‚ä»¥ä¸Šä¾‹å­ä¸­ï¼Œé€šè¿‡ä½¿ç”¨ [observeOn](https://beeth0ven.github.io/RxSwift-Chinese-Documentation/content/decision_tree/observeOn.html) æ–¹æ³•åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹æ¥ç›‘å¬å¹¶ä¸”å¤„ç†ç»“æœã€‚

MainScheduler ä»£è¡¨**ä¸»çº¿ç¨‹**ï¼ŒSerialDispatchQueueScheduler æŠ½è±¡äº†**ä¸²è¡Œ** `DispatchQueue`ï¼ŒConcurrentDispatchQueueScheduler æŠ½è±¡äº†**å¹¶è¡Œ** `DispatchQueue`ï¼ŒOperationQueueScheduler æŠ½è±¡äº† `NSOperationQueue`ã€‚



## [RxRelay](https://beeth0ven.github.io/RxSwift-Chinese-Documentation/content/recipes/rxrelay.html)

[RxRelay](https://beeth0ven.github.io/RxSwift-Chinese-Documentation/content/recipes/rxrelay.html) æ˜¯ä¸€ä¸ªåœ¨ Subjects ä¹‹ä¸Šå¾ˆå¥½çš„æŠ½è±¡å±‚ã€‚å®ƒå¯ä»¥è®©æˆ‘ä»¬å‘å‡ºå…ƒç´ ï¼Œè€Œä¸ç”¨æ‹…å¿ƒ error å’Œ completed è¿™æ ·çš„ç»ˆæ­¢äº‹ä»¶ã€‚

**RxRelay** æ—¢æ˜¯ **å¯ç›‘å¬åºåˆ—** ä¹Ÿæ˜¯ **è§‚å¯Ÿè€…**ã€‚

ä»–å’Œ **Subjects** ç›¸ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ä¸ä¼šæ¥å— `onError` æˆ– `onCompleted` è¿™æ ·çš„ç»ˆæ­¢äº‹ä»¶ã€‚

å¯ä»¥ç”¨ä»–æ¥å°è£…å‡½æ•°è°ƒç”¨ï¼Œä¾‹å¦‚ï¼š

```swift
let disposeBag = DisposeBag()
let relay = BehaviorRelay(value: "ğŸ”´")

relay
    .subscribe { print("Event:", $0) }
    .disposed(by: disposeBag)

relay.accept("ğŸ¶")
```

